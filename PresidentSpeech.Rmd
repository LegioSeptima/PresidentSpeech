---
title: "PresidentSpeech"
author: "Steven Tran"
date: "April 4, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(knitr)
library(tidytext)
library(tidyverse)
library(stringr)
source(JFK.R)

purl("bush41 first state of the union.txt", output = "Bush.R")
purl("JFK first state of the union.txt", output = "JFK.R")

nrc <- get_sentiments("nrc")

JFK <- data.frame(readLines("JFK.R"))
BUS <- data.frame(readLines("Bush.R"))

colnames(JFK) <- c("text")
colnames(BUS) <- c("text")

JFK <- JFK %>% mutate(President = "JFK")
BUS <- BUS %>% mutate(President = "Bush")

JFK[,1] <- as.character(JFK[,1])
BUS[,1] <- as.character(BUS[,1])

DATA <- JFK %>% #TOTAL COUNT
  rbind(BUS) %>% 
  unnest_tokens(word, text) %>% 
  inner_join(nrc) %>%
  count(word, sort = TRUE)
DATAJ <- JFK %>% #JFK COUNT
  unnest_tokens(word, text) %>% 
  inner_join(nrc) %>%
  count(word, sort = TRUE)
DATAB <- BUS %>% #BUSH COUNT
  unnest_tokens(word, text) %>% 
  inner_join(nrc) %>%
  count(word, sort = TRUE)
#View(DATA)
#View(DATAJ)
#View(DATAB)
#We should use these 3 tables to determine % share JFK and BUSH have of total

#TODO

#We should count differences in top 10 words
top10jfk <- head(DATAJ,10)[1] #top 10 words for jfk
top10bus <- head(DATAB,10)[1] #top 10 words for bush
compare <- top10jfk %>% 
  mutate(inTop10Bus = word %in% top10bus[[1]])
#View(top10jfk)
top10merged <- top10jfk %>% rbind(top10bus) %>% distinct
#View(top10merged)
tot = nrow(top10merged)
numsame <- 20 - tot
print("The number of words that did not change in the top 10 is") 
print(numsame)
```
